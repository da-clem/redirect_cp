// Contents of redirectBasedOnCP.js
document.addEventListener('DOMContentLoaded', () => {
  const params = new URLSearchParams(window.location.search);
  const cp = params.get('cp'); // Make sure the URL contains a 'cp' parameter

  if (cp) {
    redirectToUrlWithCity(cp, params);
  }
});

function redirectToUrlWithCity(cp, params) {
  const villeCP = {
    "mulhouse": ["68130", "68100", "68110", "68116", "68118", "68120", "68121", "68128", "68170", "68190", "68210", "68220", "68230", "68250", "68260", "68270", "68300", "68310", "68330", "68350", "68360", "68390", "68400", "68440", "68460", "68470", "68480", "68490", "68500", "68510", "68520", "68530", "68540", "68550", "68560", "68570", "68580", "68610", "68620", "68640", "68680", "68690", "68700", "68720", "68730", "68740", "68760", "68780", "68790", "68800", "68820", "68830", "68840", "68850", "68870", "68890", "68950", "68960", "68990"],
    "colmar": ["67220", "67130", "67230", "67390", "67420", "67600", "67650", "67680", "67730", "67750", "68000", "68040", "68125", "68127", "68140", "68150", "68160", "68180", "68230", "68240", "68250", "68280", "68320", "68340", "68370", "68380", "68420", "68590", "68600", "68630", "68650", "68660", "68750", "68770", "68820", "68910", "68920", "68970", "68980", "88100", "88210", "88230", "88400", "88430", "88470", "88490", "88520", "88580", "88650"],
    "brive-la-gaillarde": ["19000", "19100", "19120", "19130", "19140", "19150", "19190", "19210", "19230", "19240", "19270", "19310", "19330", "19350", "19360", "19380", "19410", "19450", "19460", "19490", "19500", "19510", "19520", "19560", "19600", "19700", "19800", "24120", "24210", "24290", "24370", "24570", "24590", "24620", "46110", "46200", "46350", "46600"],
    "champniers": ["16000", "16110", "16120", "16130", "16140", "16150", "16160", "16170", "16190", "16200", "16210", "16220", "16230", "16240", "16250", "16260", "16270", "16290", "16300", "16310", "16320", "16330", "16340", "16350", "16360", "16380", "16390", "16400", "16410", "16430", "16440", "16450", "16460", "16470", "16480", "16490", "16500", "16510", "16560", "16570", "16590", "16600", "16620", "16700", "16710", "16730", "16800", "79110", "79190", "86400"],
    "epinal": ["70210", "70320", "88000", "88100", "88110", "88120", "88130", "88140", "88150", "88190", "88200", "88210", "88220", "88240", "88260", "88270", "88320", "88330", "88340", "88370", "88380", "88390", "88400", "88410", "88420", "88430", "88440", "88450", "88460", "88470", "88480", "88500", "88510", "88530", "88550", "88600", "88640", "88650", "88700", "88800"],
    "st-denis": ["75001", "75002", "75008", "75009", "75010", "75017", "75018", "75019", "92110", "92200", "92300", "93120", "93200", "93300", "93400", "93450", "93500"],
    "aurillac": ["12140", "12420", "12460", "12600", "15000", "15100", "15110", "15120", "15130", "15140", "15150", "15160", "15170", "15190", "15200", "15210", "15220", "15230", "15240", "15250", "15260", "15270", "15290", "15300", "15310", "15320", "15340", "15350", "15380", "15390", "15400", "15430", "15450", "15500", "15580", "15590", "15600", "15700", "15800", "19110", "19160", "19200", "19220", "19430", "19550", "46100", "46120", "46160", "46190", "46210", "46270", "46320", "46400", "48140", "48200"],
    "limoges": ["16150", "16420", "16500", "19210", "19510", "23430", "87000", "87110", "87130", "87140", "87150", "87160", "87170", "87190", "87200", "87210", "87220", "87230", "87240", "87250", "87260", "87270", "87290", "87300", "87310", "87320", "87330", "87340", "87350", "87360", "87370", "87380", "87400", "87410", "87420", "87430", "87440", "87480", "87500", "87510", "87520", "87570", "87590", "87600", "87620", "87640", "87700", "87720", "87800", "87890", "87920"],
    "troyes": ["10700", "10140", "10340", "10330", "10320", "10220", "10150", "10240", "10130", "10210", "10110", "10600", "10400", "10190", "10170", "10500", "10200", "10800", "10380", "10270", "10260", "10510", "10390", "10250", "10100", "10350", "10290", "10280", "10120", "10300", "10230", "10160", "10420", "10440", "10430", "10410", "10000", "10370", "21400", "21330", "51260", "51230", "51290", "51300", "51320", "51120", "52220", "52130", "89570"],
    "epinay-sur-seine": ["92270", "92700", "92230", "92390", "93800", "93380", "93430", "95580", "95100", "95170", "95600", "95880", "95120", "95130", "95410", "95680", "95360", "95160", "95350", "95210", "95320", "95390", "95110", "95230"],
    "la-garde": ["83150", "83670", "83330", "83210", "83890", "83230", "83149", "83170", "83119", "83340", "83740", "83570", "83660", "83320", "83610", "83260", "83390", "83136", "83130", "83590", "83400", "83980", "83250", "83310", "83190", "83790", "83220", "83200", "83270", "83470", "83110", "83500", "83870", "83140", "83000", "83143", "83160", "83820", "83430"],
    "vert-st-denis": ["77390", "77720", "77630", "77560", "77115", "77590", "77350", "77310", "77930", "77240", "77171", "77160", "77370", "77820", "77380", "77170", "77190", "77166", "77133", "77850", "77127", "77550", "77000", "77650", "77950", "77176", "77920", "77210", "77111", "77870", "91800", "91860", "91230", "91480", "94520"],
    "metz": ["54610", "54800", "54560", "54150", "54530", "54700", "54580", "54490", "54620", "54980", "54890", "54640", "54111", "54470", "54780", "54310", "54240", "54380", "54970", "54960", "54660", "54750", "54870", "54910", "54121", "55400", "55300", "55230", "55210", "55270", "55150", "55100", "55430", "55160", "55240", "55110", "55320", "55840", "57920", "57590", "57111", "57360", "57580", "57130", "57640", "57680", "57530", "57176", "57300", "57050", "57310", "57159", "57420", "57365", "57160", "57245", "57070", "57120", "57210", "57175", "57144", "57157", "57140", "57000", "57158", "57860", "57117", "57250", "57780", "57118", "57124", "57525"],
    "sarreguemines": ["57340", "57410", "57580", "57380", "57670", "57520", "57660", "57730", "57320", "57170", "57690", "57220", "57450", "57260", "57460", "57800", "57550", "57200", "57230", "57720", "57490", "57590", "57150", "57980", "57136", "57510", "57600", "57430", "57470", "57880", "57910", "57630", "57990", "57114", "57740", "57540", "57890", "57530", "57500", "57115", "57350", "57137", "57145", "67260", "67970"],
    "sens": ["10130", "10210", "21500", "21460", "21330", "21210", "21530", "21140", "58200", "58190", "58450", "58800", "58500", "58310", "58210", "58140", "58460", "58530", "58410", "58230", "89800", "89110", "89390", "89160", "89480", "89440", "89200", "89310", "89380", "89270", "89740", "89660", "89450", "89290", "89000", "89430", "89400", "89460", "89250", "89630", "89240", "89360", "89700", "89570", "89420", "89230", "89113", "89210", "89350", "89300", "89580", "89600", "89530", "89560", "89130", "89520", "89550", "89170", "89144", "89470", "89710"],
    "tomblaine": ["54115", "54740", "54770", "54460", "54170", "54112", "54450", "54200", "54540", "54470", "54110", "54760", "54370", "54510", "54380", "54160", "54385", "54210", "54122", "54120", "54290", "54550", "54360", "54610", "54940", "54480", "54300", "54700", "54113", "54136", "54930", "54280", "54134", "54420", "54230", "54250", "54330", "54670", "54119", "54130", "54830", "54270", "54690", "54630", "54710", "54840", "54570", "54390", "54180", "54140", "54114", "54410", "54950", "54520", "54129", "54220", "54820", "54320", "54850", "54118", "54000", "54340", "54116", "54500", "54600", "54123", "54990", "55130", "55300", "55200", "55140", "55190", "57590", "57170", "57630", "57810", "88140", "88500", "88170", "88300", "88130", "88800", "88630", "88700"],
    "poitiers": ["16490", "37160", "37800", "37350", "37290", "37120", "49260", "79200", "79600", "79390", "79800", "79420", "79190", "79120", "79340", "79450", "79330", "79100", "86430", "86110", "86700", "86260", "86330", "86310", "86100", "86200", "86210", "86340", "86250", "86530", "86460", "86170", "86190", "86490", "86120", "86420", "86000", "86800", "86400", "86300", "86410", "86390", "86290", "86160", "86510", "86180", "86600", "86140", "86380", "86360", "86350", "86370", "86450", "86320", "86270", "86240", "86220", "86130", "86150", "86500", "86470", "86230", "86550", "86440", "86480", "86280", "86540", "86580"],
    "st-ouen-l-aumone": ["78570", "78700", "78740", "78780", "95450", "95810", "95430", "95250", "95260", "95750", "95550", "95840", "95000", "95650", "95640", "95660", "95560", "95420", "95240", "95830", "95800", "95300", "95610", "95740", "95530", "95690", "95220", "95290", "95280", "95180", "95630", "95540", "95370", "95590", "95270", "95520", "95620", "95340", "95480", "95310", "95150", "95760", "95490", "95570", "95330"],
    "st-maximin": ["60940", "60250", "60300", "60140", "60810", "60540", "60460", "60820", "60440", "60870", "60600", "60290", "60230", "60500", "60520", "60660", "60580", "60100", "60530", "60950", "60330", "60270", "60260", "60160", "60128", "60180", "60560", "60340", "60740", "60730", "60550", "95270", "95340", "95820", "95470"],
  };

  let ville = Object.keys(villeCP).find(ville => villeCP[ville].includes(cp));

  if (ville) {
    const newBaseURL = `https://skoda-superb-essai.novperfs.com/concessions/${ville}`;
    const finalUrl = `${newBaseURL}?${params.toString()}`;
    window.location.href = finalUrl;
  } else {
    console.log("Code postal non géré.");

  }
}
