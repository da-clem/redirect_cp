// Contents of redirectBasedOnCP.js
document.addEventListener('DOMContentLoaded', () => {
  const params = new URLSearchParams(window.location.search);
  const cp = params.get('cp'); // Make sure the URL contains a 'cp' parameter

  if (cp) {
    redirectToUrlWithCity(cp, params);
  }
});

function redirectToUrlWithCity(cp, params) {
  const villeCP = {
    "nice": ["01615", "02499", "04170", "04240", "04320", "04660", "06000", "06002", "06009", "06000", "06012", "06046", "06050", "06100", "06104", "06105", "06140", "06190", "06200", "06201", "06203", "06205", "06209", "06230", "06240", "06260", "06270", "06279", "06290", "06299", "06300", "06310", "06320", "06330", "06340", "06353", "06357", "06360", "06380", "06390", "06420", "06430", "06440", "06450", "06470", "06480", "06500", "06509", "06510", "06540", "06570", "06610", "06640", "06660", "06670", "06690", "06700", "06703", "0670p", "06710", "06730", "06790", "06800", "06830", "06910", "06950", "09511", "19135", "20132", "21332", "27156", "31302", "38700", "56900", "61002", "78129", "78369", "90738", "98000", "99000"],
    "valenciennes": ["05953", "29234", "31898", "58163", "58880", "59121", "59125", "59135", "59144", "59154", "59158", "59163", "59174", "59178", "59192", "59195", "59199", "59213", "59220", "59224", "59226", "59230", "59233", "59243", "59255", "59264", "59269", "59278", "59288", "59294", "59300", "59309", "59410", "59419", "59494", "59507", "59530", "59590", "59690", "59699", "59770", "59860", "59880", "59920", "59970", "59990"],
    "cannes": ["03276", "04120", "04169", "04330", "06004", "06029", "06069", "06085", "06095", "06110", "06112", "06113", "06130", "06139", "06150", "06160", "06210", "06219", "06220", "06250", "06265", "06370", "06400", "06409", "06410", "06460", "06520", "06530", "06550", "06560", "06580", "06590", "06600", "06606", "06620", "06650", "06680", "06715", "06740", "06750", "06780", "06810", "06819", "06850", "06901", "06902", "06905", "06906", "10404", "12113", "15817", "20126", "20704", "35202", "75999", "83440", "85250", "06400", "06530"],
    "brive-la-gaillarde": ["19000", "19012", "19013", "19100", "19103", "19109", "19130", "19140", "19150", "19190", "19230", "19240", "19270", "19310", "19330", "19350", "19360", "19450", "19460", "19490", "19500", "19510", "19520", "19560", "19600", "19700", "21101", "24120", "24210", "24547", "24570", "46110", "46200", "46350", "46600", "94089"],
    "angouleme": ["12328", "16000", "16021", "16110", "16120", "16140", "16150", "16160", "16170", "16190", "16200", "16204", "16210", "16220", "16230", "16240", "16250", "16260", "16270", "16290", "16310", "16313", "16320", "16330", "16340", "16350", "16356", "16380", "16400", "16410", "16430", "16440", "16450", "16460", "16470", "16480", "16490", "16500", "16510", "16560", "16570", "16590", "16600", "16620", "16700", "16710", "17899", "53026"],
    "saintes": ["01145", "16028", "16100", "16130", "16174", "16300", "16360", "16370", "16720", "17100", "17110", "17113", "17120", "17130", "17132", "17150", "17160", "17200", "17240", "17250", "17260", "17350", "17390", "17420", "17460", "17490", "17500", "17520", "17530", "17570", "17600", "17610", "17640", "17750", "17770", "17800", "17810", "17890", "17920", "25501", "33480", "59116", "79939", "97411", "97421"],
    "saint-thibault-des-vignes": ["05984", "07729", "07760", "13331", "21012", "48160", "69056", "73390", "77090", "77131", "77141", "77144", "77151", "77163", "77164", "77174", "77177", "7717P", "77181", "77183", "77185", "77186", "77200", "77270", "77290", "77299", "77200", "77360", "77400", "77401", "77410", "77414", "77419", "77420", "77540", "77560", "77600", "77970", "93460", "93561", "95973"],
    "vienne": ["08014", "26210", "26390", "36540", "38121", "38122", "38138", "38150", "38190", "38200", "38209", "38270", "38299", "38370", "38550", "38670", "38780", "42520", "69420", "69520", "69560", "69624", "69970", "69989"],
    "dole": ["03929", "21130", "21170", "21470", "39120", "39290", "39350", "39380", "39410", "39500", "39700", "70100", "71270"],
    "la-rochelle": ["21170", "21470", "39120", "39290", "39350", "39380", "39410", "39500", "39700", "70100", "71270", "01730", "03710", "06187", "17000", "17019", "17023", "17026", "17111", "17123", "17135", "17137", "17138", "17139", "17140", "17170", "17180", "17190", "17220", "17285", "17290", "17300", "17302", "17308", "17310", "17320", "17340", "17370", "17410", "17430", "17440", "17450", "17540", "17550", "17560", "17580", "17590", "17620", "17630", "17650", "17670", "17690", "17700", "17730", "17740", "17780", "17840", "17870", "17880", "17940", "20123", "62136", "78517", "85370", "85450", "85460", "85770", "97413"],
    "epinay-sur-seine": ["01970", "07502", "07781", "09510", "09623", "10001", "12369", "17102", "34360", "57124", "59267", "62193", "66933", "76151", "78563", "78582", "92230", "92390", "92399", "92624", "92671", "92700", "93380", "93430", "93439", "9343p", "93509", "93800", "93880", "93899", "95109", "95110", "95120", "95130", "95139", "95160", "95169", "95170", "95210", "9527o", "95320", "95322", "95350", "95360", "95390", "95410", "95580", "95600", "95609", "95645", "95680", "95880", "97228"],
    "limoges": ["00008", "07214", "08051", "13153", "15041", "16420", "19210", "19410", "22350", "29869", "36121", "87000", "87010", "87038", "87042", "87065", "87068", "87085", "87100", "87110", "87130", "87140", "87144", "87150", "87160", "87170", "87190", "87200", "87210", "87220", "87230", "87240", "87250", "87260", "87270", "87280", "87290", "87300", "87310", "87330", "87340", "87350", "87360", "87370", "87380", "87400", "87410", "87420", "87430", "87440", "87480", "87500", "87510", "87520", "87560", "87570", "87590", "87600", "87620", "87640", "87700", "87720", "87800", "87890", "87920", "97261", "97423"],
    "bretigny-sur-orge": ["01033", "09135", "09150", "09170", "31480", "34305", "45660", "56014", "71105", "75230", "76341", "78127", "85279", "91070", "91150", "91159", "91160", "91169", "91170", "91179", "91200", "91210", "91220", "91240", "91260", "91270", "91279", "91290", "91310", "91340", "91341", "91350", "91359", "91360", "91380", "91390", "91420", "91429", "91430", "91510", "91520", "91580", "91600", "91630", "91650", "91660", "91670", "91690", "91692", "91700", "91730", "91740", "91770", "91780", "91790", "91799", "91810", "91850", "91870", "91880", "91910", "91930", "91941", "94346", "96600", "97180"]
  };

  let ville = Object.keys(villeCP).find(ville => villeCP[ville].includes(cp));

  if (ville) {
    const newBaseURL = `https://skoda-fabia-essai.novperfs.com/concessions/${ville}`;
    const finalUrl = `${newBaseURL}?${params.toString()}`;
    window.location.href = finalUrl;
  } else {
    console.log("Code postal non géré.");
  }
}
